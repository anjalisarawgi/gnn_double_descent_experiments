import pandas as pd
import matplotlib.pyplot as plt

import pandas as pd
import matplotlib.pyplot as plt

# noise 0.0
# data_last_epoch = {
#     'Hidden Dimensions': [ 2, 4, 8, 16, 20, 24, 28, 32, 36, 40, 45, 46, 48, 50, 52,54 ,55, 60, 64, 70, 75, 80, 85, 90, 95, 128, 200, 256, 300, 400, 512, 600, 800, 900, 1024],
#     'Test loss': [1.5686571884758864,1.1392260397536844, 0.8269845513410347, 0.33425210831286034, 0.31793652109424525, 0.314004071811332, 0.32852902235109593, 0.37173794504384733, 0.3980613097303865, 0.4508215976949734, 0.4597625707783088, 0.45019462901017265, 0.4610640327090654, 0.4976759713509303, 0.47183447798325007, 0.48354138638470556, 0.4858410611890162, 0.4490387858962014, 0.4566830988985168, 0.4479207679246371, 0.4166632400106497, 0.41302139922735004, 0.4234176781223763, 0.3873651727888132, 0.4007505940084045, 0.4019180402748937,0.3746090931222156,  0.38661683093385685,0.3515481764116378,  0.37664348672934456,  0.402794327875071, 0.36123048018506076, 0.38181689025443605, 0.37355755187098966, 0.4119512118549371 ],
#     'Train loss': [1.60587939162587, 1.1771496347216672, 0.8045081337795982, 0.2556130457582862, 0.2150883296547934, 0.1365896580264319, 0.0767006910341077, 0.04284078757993357, 0.029225791427631712, 0.010276174181693255, 0.0031954898539562383, 0.003975751904126387, 0.0020609109330486483, 0.0008419677592914817, 0.00030903912264515975, 0.0007828587663784992, 0.0002996831166794521, 0.00012668541911553738, 7.768908164116298e-05, 6.154115340154402e-05, 4.6626907607237945e-05, 3.359793776812588e-05, 1.1676453992526001e-05, 1.3950025497389255e-05, 1.1135361907973717e-05, 1.3044370698308782e-06, 2.957894064162312e-07, 3.232340020061502e-07,6.565690189649338e-07, 1.241862619024677e-07,  7.324471149723653e-08, 1.8728679329254503e-07, 1.0972902481346034e-07, 2.1443349643235097e-07, 1.949243796526692e-07]
# }

# noise 0.20
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 80, 90, 100, 120, 130, 140, 150, 160, 170, 180, 190, 200, 400, 600, 800, 1000],
#     'Test loss': [2.0904935040051424, 1.963245628755304, 1.8582205923297737, 1.7327526581438282, 1.6288808388046072, 1.5890408362014383, 1.5224044768116145, 1.453360761268229, 1.4717250451256958, 1.3994738965094844, 1.2939016275768038, 1.241262189949615, 1.2345570552198193, 1.2062132396275485, 1.2096553346778771, 1.2221674632422532, 1.2023912939844252, 1.2481371873541722, 1.320410295377804, 1.4228024082847788, 1.4643185915826242, 1.609070615677894, 1.700068945371652, 2.022255633450761, 2.3423594824875456, 2.42312584194956, 3.3355594692350943, 4.102870277211636, 4.304305290874047, 4.931659707540198, 5.006630399559118, 5.28632599794412, 5.269181200220615, 5.22152656543104, 5.316263883928709, 5.371609207950061, 5.25424832633779, 5.262376504608348, 5.335509309285803, 5.414589649514307, 5.470659246927576, 5.4028367573701885],
#     'Train loss':[2.08578194823376, 1.9683290043542552, 1.853977317311043, 1.73168434570002, 1.6350049074306043, 1.584888900435248, 1.5067032406496448, 1.4492267295371657, 1.4571591723796933, 1.3875518435655638, 1.2481133240599964, 1.187292512627535, 1.1777737270954045, 1.1179022705832191, 1.0989371291426726, 1.0940808770268462, 1.0397079176680986, 0.9776971252851708, 0.893006224549094, 0.8196256594602451, 0.773132330802984, 0.6922937385564627, 0.6131997960944509, 0.4839841999979906, 0.3811138691250668, 0.3306744592134342, 0.1250448325778856, 0.0427764120165172, 0.0230815239510563, 0.0029690314040974, 0.0009015730969326, 0.0004145748615312, 0.0002324056663488, 0.000183766185711, 0.0001068939540472, 6.691595491818504e-05, 5.610823718280847e-05, 4.826617259611741e-05, 2.84784478369972e-06, 1.089648800799761e-06, 6.853772163140093e-07, 6.580669657568631e-07],
# }

# noise 0.20 with sgd 0.01 and 0.9
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 50, 55, 60, 70, 80, 85, 90, 95, 100, 105, 108, 110, 112, 115, 120, 125, 130, 140, 150, 160, 170, 180, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Test loss':  [2.088586102558088, 1.957440907442117, 1.83087844486478, 1.7142444396320775, 1.6514828657802147, 1.6011863660208787, 1.5545580681366256, 1.4513312140597572, 1.4012163409703895, 1.4396034003813056, 1.2978272362600398, 1.2486062283757366, 1.2210228322427483, 1.1976541484458536, 1.2201758691027194, 1.1943292165104349, 1.1915685700464853, 1.2519339338133606, 1.1934467403194573, 1.3651417116575604, 1.273691796049287, 1.4515456285657762, 1.3416268682178063, 1.77136998086036, 2.103044037577472, 2.364956056015401, 2.9290112905864474, 3.4939220917375784, 3.277522681634637, 3.5120372425151776, 4.274333573594878, 4.260549813886232, 3.9429562876496136, 4.000016396558737, 4.500942432427708, 4.217059588130517, 4.659221842319151, 4.522122687931303, 4.608004630366458, 4.884056233152559, 4.893922838983657, 4.986555627629727, 5.008340123333508, 4.993534374840652, 5.07586281510848, 5.074732155739507, 5.262151567241814, 5.093395073202592, 5.306468713132641, 5.208847284317017, 2.5986800510672072, 2.618330760847164],
#     'Train loss':[2.087906659758368, 1.9596371808717417, 1.8350112285724909, 1.7130131860112034, 1.6540922630664914, 1.60186520925788, 1.5550309968549152, 1.4480594399363496, 1.389087557515433, 1.4179784389429315, 1.2859010980572811, 1.2124028409636298, 1.1838590971259184, 1.1429361063380574, 1.1307129294373268, 1.1204827736976537, 1.089011063409406, 1.0014273919338403, 0.9998903978702632, 0.8744372520335885, 0.8949141294457191, 0.7749637306429619, 0.8051454320896504, 0.5857161162897598, 0.426718631871911, 0.2920181600853454, 0.1606321368799653, 0.0696726085791407, 0.1019848535573759, 0.0650898157727233, 0.0143953881432237, 0.0140269061333911, 0.0239240741313889, 0.0185521860466187, 0.0059415280477815, 0.0102806054071934, 0.0021362964706874, 0.0049422631134972, 0.0015596871962093, 0.0002983641009344, 0.0002225698956165, 0.0001563717739224, 0.0001100321171221, 4.336557369327259e-05, 8.903270527615711e-06, 3.174857208652484e-06, 9.09244395314164e-07, 1.3483477736171216e-06, 5.237155160188628e-07, 9.387658794861276e-07, 0.0020304464683651, 0.0020507084971921]
# }

# 0.10 noise adam 0.001 
data_last_epoch = {
    'Hidden Dimensions':   [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 14, 16, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
    'Test loss': [2.0176196219045903, 1.8191817350025417, 1.7022397457798826, 1.5125563386120373, 1.3881235899804514, 1.1898623984071273, 1.1176370329494718, 1.109501245655591, 1.0710887410972691, 0.9331489288354222, 0.856735993035232, 0.8498582836193375, 0.8297106499158884, 0.8316667113877549, 0.8707132705404789, 0.8799950454054, 1.0203340743915943, 1.156568836562241, 1.222476463529128, 1.3796254117277604, 1.68861787832236, 1.961037827443473, 1.94144070148468, 2.675202052804488, 2.634767162648937, 2.727253431006323, 2.84424625921853, 3.0555781231650823, 3.0244792895981027, 3.010259501541717, 2.9596553739113145, 2.9899406236938284, 3.0314320853993864, 3.065724505653864, 3.024669090403786, 3.010949834992614, 3.0597377653363385, 3.0421895045268386, 3.031314821182927, 3.091067784949194, 3.090935681439653, 3.127355127394954, 3.0967214967631085, 3.198875051510485, 3.2788058142118817, 3.273591433899312, 3.2897664218009277, 3.292920924440215, 3.403544296192217, 3.2230093101911907],
    'Train loss':[2.015533615822016, 1.837614319213601, 1.7239973173585048, 1.5122895969900974, 1.4254723803941594, 1.2126625036084375, 1.1248138883779215, 1.081358722476072, 1.079263536597407, 0.905012200322262, 0.8105312862368517, 0.7909110803936803, 0.7303768550240717, 0.6493857238181802, 0.5852782794209413, 0.5560919663933821, 0.4528858912199042, 0.3757914548003396, 0.3324512548917948, 0.2652582562246988, 0.175237061014009, 0.0939841959365578, 0.0821773331222492, 0.0086468360088982, 0.0150735480987012, 0.0072494684033593, 0.0033373297694366, 0.0006470163442975, 0.0011575854724871, 0.0004700511195466, 0.000507088198897, 0.0003764362584767, 0.0002682917103896, 0.0001705604908978, 5.999444176141392e-05, 6.806277890994585e-05, 7.911211812740454e-05, 3.672764165817488e-05, 2.08867499691752e-05, 1.3936125429439884e-05, 1.4280208033543986e-05, 1.0488828100669918e-05, 2.174319324443638e-06, 1.0458258147205174e-06, 4.37513979369045e-07, 4.26578341204525e-07, 2.758312126963156e-07, 2.1144057095784245e-07, 1.7682312531808702e-07, 5.301796564149458e-07]
}


df_last_epoch = pd.DataFrame(data_last_epoch)

df_last_epoch.to_csv('noise_0.20/last_epoch/loss.csv', index=False)

# Plot the data
plt.figure(figsize=(15, 8))
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Train loss'], marker='o', label='Train Loss', color='red')
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Test loss'], marker='o', label='Test Loss', color='blue')
plt.title('Results - loss curves - last epoch')
plt.xlabel('Hidden Dimensions')
plt.ylabel('Loss')
plt.legend()
# plt.xticks(df_last_epoch['Hidden Dimensions'])
plt.xticks(range(0, 1100, 50), fontsize=10)
plt.grid(True)
plt.tight_layout() 
plt.savefig('noise_0.20/last_epoch/loss_vs_hidden_dimensions.png')  # Save the plot as an image file