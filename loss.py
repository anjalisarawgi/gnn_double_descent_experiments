import pandas as pd
import matplotlib.pyplot as plt

import pandas as pd
import matplotlib.pyplot as plt

# method = "adam_0.001"

# MNIST 
dataset = "mnist"

# noise = "noise_0.10"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 14, 16, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.015533615822016, 1.837614319213601, 1.7239973173585048, 1.5122895969900974, 1.4254723803941594, 1.2126625036084375, 1.1248138883779215, 1.081358722476072, 1.079263536597407, 0.905012200322262, 0.8105312862368517, 0.7909110803936803, 0.7303768550240717, 0.6493857238181802, 0.5852782794209413, 0.5560919663933821, 0.4528858912199042, 0.3757914548003396, 0.3324512548917948, 0.2652582562246988, 0.175237061014009, 0.0939841959365578, 0.0821773331222492, 0.0086468360088982, 0.0150735480987012, 0.0072494684033593, 0.0033373297694366, 0.0006470163442975, 0.0011575854724871, 0.0004700511195466, 0.000507088198897, 0.0003764362584767, 0.0002682917103896, 0.0001705604908978, 5.999444176141392e-05, 6.806277890994585e-05, 7.911211812740454e-05, 3.672764165817488e-05, 2.08867499691752e-05, 1.3936125429439884e-05, 1.4280208033543986e-05, 1.0488828100669918e-05, 2.174319324443638e-06, 1.0458258147205174e-06, 4.37513979369045e-07, 4.26578341204525e-07, 2.758312126963156e-07, 2.1144057095784245e-07, 1.7682312531808702e-07, 5.301796564149458e-07],
#     'Test loss':[2.0176196219045903, 1.8191817350025417, 1.7022397457798826, 1.5125563386120373, 1.3881235899804514, 1.1898623984071273, 1.1176370329494718, 1.109501245655591, 1.0710887410972691, 0.9331489288354222, 0.856735993035232, 0.8498582836193375, 0.8297106499158884, 0.8316667113877549, 0.8707132705404789, 0.8799950454054, 1.0203340743915943, 1.156568836562241, 1.222476463529128, 1.3796254117277604, 1.68861787832236, 1.961037827443473, 1.94144070148468, 2.675202052804488, 2.634767162648937, 2.727253431006323, 2.84424625921853, 3.0555781231650823, 3.0244792895981027, 3.010259501541717, 2.9596553739113145, 2.9899406236938284, 3.0314320853993864, 3.065724505653864, 3.024669090403786, 3.010949834992614, 3.0597377653363385, 3.0421895045268386, 3.031314821182927, 3.091067784949194, 3.090935681439653, 3.127355127394954, 3.0967214967631085, 3.198875051510485, 3.2788058142118817, 3.273591433899312, 3.2897664218009277, 3.292920924440215, 3.403544296192217, 3.2230093101911907]
# }

# others 
# method = "sgd_0.01_0.9"
# noise = "noise_0.20"
# data_last_epoch = {
#     'Hidden Dimensions':[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 50, 55, 60, 70, 80, 90, 100, 120, 140, 150, 160, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.087906659758368, 1.9596371808717417, 1.8350112285724909, 1.7130131860112034, 1.6540922630664914, 1.60186520925788, 1.5550309968549152, 1.4480594399363496, 1.389087557515433, 1.4112541265265883, 1.2859010980572811, 1.2124028409636298, 1.1838590971259184, 1.1429361063380574, 1.14884710880213, 1.1204827736976537, 1.089011063409406, 1.0056194229181423, 0.9998903978702632, 0.962362890742546, 0.8949141294457191, 0.932188491488612, 0.8051454320896504, 0.7981964306775914, 0.668021372723025, 0.6006130356428235, 0.3854027338152708, 0.4098108103802038, 0.3443878648586051, 0.2255391632055127, 0.0453551449834607, 0.0393352930325754, 0.0142783024229195, 0.0090275165570769, 0.0062023547136896, 0.0049329300898365, 0.004242776751215, 0.0040338616736969, 0.0023254649751538, 0.0020304464683651, 0.0020507084971921],
#     'Test loss':[2.088586102558088, 1.957440907442117, 1.83087844486478, 1.7142444396320775, 1.6514828657802147, 1.6011863660208787, 1.5545580681366256, 1.4513312140597572, 1.4012163409703895, 1.4232776979856854, 1.2978272362600398, 1.2486062283757366, 1.2210228322427483, 1.1976541484458536, 1.21100205333927, 1.1943292165104349, 1.1915685700464853, 1.1940276049360443, 1.1934467403194573, 1.2344428693191916, 1.273691796049287, 1.2217361889308012, 1.3416268682178063, 1.3629289314716675, 1.504166141341004, 1.5691861910156055, 1.904091294807724, 1.8331404698045948, 1.884454933902885, 2.0421702318553683, 2.719790934007379, 2.68209461924396, 2.8541454710537875, 2.6741508456725107, 2.6454083904435364, 2.6021331941025165, 2.5432619429841825, 2.5116860504391827, 2.556232885469364, 2.5986800510672072, 2.618330760847164]
# }

######################################################################################################################
# CIFAR10 

# dataset="cifar10"

# noise = "noise_0.0"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 155, 200, 300, 500, 600, 700, 800, 900, 1000],
#     'Train loss':[2.088652094656771, 1.921666229990396, 1.8504936278543689, 1.751878629692576, 1.703234439207749, 1.623055856336247, 1.5991047935729676, 1.5240627296946263, 1.4998935549096628, 1.4739042347805067, 1.357667434621941, 1.311247892677784, 1.2642062208191915, 1.234261015938087, 1.1746550359847872, 1.1748074812983924, 1.1062869727611542, 0.9505404631861232, 0.8852150966836647, 0.7741396715017882, 0.7455991211939942, 0.5217971563000571, 0.378751103893261, 0.2573590323074974, 0.1717037213754586, 0.1242830485888672, 0.1143903595882214, 0.06866811781021, 0.0336373863723234, 0.0208567172786305, 0.0146781387222951, 0.0125667967427447, 0.005932896658454, 0.0037490732217768, 0.0035269479834493, 0.0026963514936307, 0.0018014741689181, 0.0011051871177766, 0.0009847172729099, 0.0006031556006291, 0.0003716708550675, 0.0001028838830476, 2.582415341188173e-05, 9.428813951343914e-06, 5.818499395101898e-06, 5.024333183198141e-06, 4.002200097391102e-06, 4.17063199491126e-06, 4.404556896663404e-06],
#     'Test loss': [2.081921698171881, 1.9160759101940104, 1.8451510079299347, 1.7312518373320374, 1.718138791337798, 1.612104524539996, 1.6152343568922598, 1.5401702817482283, 1.5200082893613018, 1.479970348032215, 1.4054747774631162, 1.3804342112963712, 1.3483881467505343, 1.351209702371042, 1.3356649739832818, 1.3521278447742704, 1.3029018768781349, 1.3652484748936906, 1.3936037881464898, 1.560463028618052, 1.5028805461110948, 1.851388558556762, 2.0571374666841726, 2.357060098949867, 2.656457603732242, 2.979140954681589, 2.937795240667802, 3.148790392694594, 3.467621350590187, 3.5699810800673086, 3.7156940774072575, 3.799126148223877, 4.073057198826271, 3.864559997486163, 3.914963000937353, 3.8549122689645503, 3.950045600722108, 4.082204945479767, 4.096460656274723, 4.056628933435754, 4.05681978298139, 4.093354593349408, 3.949212958541097, 3.773733268810224, 3.759704541556443, 3.733867835394944, 3.715147489233862, 3.713838918299615, 3.6449283346345154]
# }

# noise = "noise_0.10"    
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30, 32, 35, 40, 45, 50, 55, 60, 64, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 128, 130, 135, 140, 145, 200, 256, 300, 400, 512, 600, 700, 800, 900, 1000],
#     'Train loss':[2.1417064849625933, 1.998686808076772, 1.9694648300382225, 1.8940174132585528, 1.8745401864024729, 1.8136846782131628, 1.7656417590650646, 1.7424287318506024, 1.7095086141066118, 1.669380278072574, 1.615083288740028, 1.5627141638912938, 1.5233345803889362, 1.4956116266548634, 1.4634385867552324, 1.3801303262060338, 1.2768064876171676, 1.2476500547067686, 1.1912746507335792, 1.1274677410044454, 1.052069106054577, 0.9263710531998764, 0.819187989119779, 0.7165211832828142, 0.642997526563704, 0.5115102781829509, 0.42387435445562, 0.3672078728083182, 0.2433970227033238, 0.1839592199222269, 0.0833201304247433, 0.0550927555887028, 0.0371848898357711, 0.0222863626020791, 0.013355688504155, 0.0097018278224409, 0.0065882698108907, 0.0036612245292582, 0.0059960663093079, 0.0027180056970544, 0.002988885210057, 0.0024378193924845, 0.0001974223607961, 5.871168435657058e-05, 4.112228675849524e-05, 1.3324781163377834e-05, 1.0088484493050744e-05, 5.095969851512646e-06, 8.413468165713311e-06, 4.9623024219029466e-06, 4.878874619055037e-06, 4.394976401316859e-06],
#     'Test loss': [2.133337274382386, 1.987140797361543, 1.956050125858452, 1.8758832261532168, 1.8613230835033368, 1.803558648387088, 1.7560972080955022, 1.744848396204695, 1.7062576254711876, 1.6806199927873249, 1.6500604031961177, 1.6139006388338306, 1.609555929521971, 1.6161476931994474, 1.6078180934809432, 1.6089785114119324, 1.6389274551898618, 1.599985425985312, 1.6970822554600389, 1.7610341717925253, 1.7883180394957336, 1.9170096614692784, 2.126671569256843, 2.2604485916185983, 2.3781634373000906, 2.6493192352826083, 2.8566112005257907, 3.0822872964641714, 3.567893148977545, 3.710925488532344, 4.461452988129627, 4.630279160753081, 4.90162177327313, 5.34946872614607, 5.475829984568343, 5.487114495868925, 5.7484905297243145, 5.909994970394086, 5.567079314702673, 5.8848091982587984, 5.828729701947562, 5.797602967370914, 6.068015623696243, 5.850295504437217, 5.821570680111269, 5.657618848583367, 5.622812904889071, 5.52404652667951, 5.569872433626199, 5.512833106366894, 5.486212980898121, 5.450845573521868]
# }

# noise = "noise_0.20"    
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.1831094182350417, 2.097308375280012, 2.064494512975216, 2.01915953443809, 1.980272962288423, 1.9290285591374745, 1.9197751073674725, 1.8485252633690836, 1.8696716089140288, 1.8250231424515897, 1.7752816765145822, 1.749801574444229, 1.715474669906226, 1.6686391891403631, 1.6453391760587692, 1.598515601659363, 1.5335412987253882, 1.415911911224777, 1.405443114651875, 1.2609785642813554, 1.1743815459988334, 1.103973396291787, 1.003716597164219, 0.8472031112760305, 0.7115029450505972, 0.6514437357810411, 0.4762692296538841, 0.3644623897800391, 0.3001939181915738, 0.1449002879460088, 0.1099104231371629, 0.0832519794613207, 0.0539070575614459, 0.0294039155798435, 0.0095276510364783, 0.0088940428375446, 0.0041841049920053, 0.0028599628311977, 0.0012379373313871, 0.0008470734497181, 0.0005061904182536, 0.0002915640360986, 0.0001358358729042, 2.331693680575468e-05, 1.7873541045270773e-05, 7.508091432452023e-06, 4.817070209384156e-06, 4.694389304595668e-06, 6.597937670963202e-06, 3.602760542262021e-06],
#     'Test loss': [2.1798473581483093, 2.08978681775588, 2.05950294416162, 2.009645440910436, 1.979845279379736, 1.9268716981139364, 1.9318107517459724, 1.8917634155176863, 1.8782191336909424, 1.8456361761576008, 1.8182006108609936, 1.7965923230859298, 1.78646783436401, 1.7994585505014733, 1.796319766889645, 1.820375404780424, 1.8413621021222464, 1.9310653617110436, 1.9274234409573712, 2.0184869404080548, 2.1513118924973886, 2.218454797056657, 2.3586879440500765, 2.621439639526077, 2.908761501312256, 2.995512219923961, 3.587300647663165, 3.9926273098474816, 4.212440807608109, 5.097677903839305, 5.279251641865018, 5.697241511525987, 6.140512037880813, 6.25652555272549, 6.904237578186808, 6.910548216179956, 7.245659882509256, 7.226821169068541, 7.322778955290589, 7.326033791409263, 7.349701386463793, 7.468631973749475, 7.217922554740423, 7.281879352617867, 7.080351310440257, 6.986111556427388, 7.0887729367123375, 6.817135919498492, 6.6814224689821655, 6.787775323360781]
# }


######################################################################################################################
# mutagenicity
# seed = "41"
# noise = "noise_0.0"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 14, 16, 18, 20, 22, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 90, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss':  [0.5789380009685244, 0.4737842093620981, 0.4755757195608956, 0.4325685543673379, 0.4317615266357149, 0.3688649364880153, 0.3318187658275877, 0.3196407865200724, 0.3283297733536788, 0.2930399488125528, 0.2633864576263087, 0.2296887253011976, 0.1968369209872824, 0.1872361592416252, 0.1391470323183707, 0.1177019180197801, 0.1230244290615831, 0.0738733885144548, 0.108028237840959, 0.1144547829670565, 0.0827224275895527, 0.0791077334433794, 0.0562250270242137, 0.0714228356789265, 0.0502708667357053, 0.0607507773009794, 0.0388798191810825, 0.0468038957832115, 0.0212072595355234, 0.0288793960519667, 0.0366689350589045, 0.028291206673852, 0.0125203233578109, 0.0312586805583643, 0.0300966584389763, 0.0213956641299384, 0.042021042268191, 0.0242334865698856, 0.0182961225842258, 0.0221535214888198, 0.0111461627363626, 0.0174462853132614, 0.0184399005458025, 0.0114199182717129, 0.0142402673372998, 0.0181549161373238, 0.0151365387719124, 0.0112442054419911, 0.0167509885338534, 0.0205367362525846, 0.0187596387362905, 0.0228169449338955, 0.0296156529636521, 0.0383667026513389, 0.0278901301124798, 0.0304486445550407],
#     'Test loss':[0.5701285749673843, 0.4982378035783767, 0.5139067247509956, 0.4704031348228454, 0.4553766846656799, 0.3868169039487839, 0.4560366347432136, 0.3968914002180099, 0.4435945004224777, 0.4032083451747894, 0.4522974044084549, 0.4218545034527778, 0.4202354177832603, 0.4445005878806114, 0.5574311763048172, 0.4771700203418731, 0.5505867153406143, 0.4668575823307037, 0.5451489835977554, 0.4713874906301498, 0.5023876130580902, 0.5616699606180191, 0.6319024041295052, 0.5336385518312454, 0.6705876067280769, 0.5741195231676102, 0.5757289007306099, 0.507670097053051, 0.6477099880576134, 0.6841125786304474, 0.5735652670264244, 0.5778006613254547, 0.7113306075334549, 0.6277232766151428, 0.6187898218631744, 0.681055873632431, 0.7055519670248032, 0.6362913697957993, 0.7517076283693314, 0.6520889550447464, 0.6732692569494247, 0.5829554349184036, 0.7137271016836166, 0.6314901262521744, 0.6172655746340752, 0.6430253982543945, 0.7649897634983063, 0.7329133152961731, 0.8055959492921829, 0.7671938538551331, 0.7710115760564804, 0.8156988173723221, 0.7305807322263718, 0.7532601356506348, 0.8513428270816803, 0.7368466109037399]
# }

# seed = "42"
# noise = "noise_0.0"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss':  [0.6051427551678249, 0.4868623188563755, 0.4802490419575146, 0.4610391046319689, 0.4047135966164725, 0.3924618182437761, 0.3491130588310105, 0.3318251126578876, 0.3222261864159788, 0.2715198482785906, 0.2637003899684974, 0.232373835252864, 0.2226645935858999, 0.226729357349021, 0.2122547711644853, 0.1618206075259617, 0.1602925546467304, 0.1354592610150575, 0.1050449588469096, 0.1167746984532901, 0.091763961927167, 0.0948824515300137, 0.0718029545886176, 0.0503325337943221, 0.1010207760014704, 0.0545706143602728, 0.0445708812081388, 0.0537539143780512, 0.044553385315729, 0.026905871728169, 0.0615459384529718, 0.0338236625705446, 0.0382997746845441, 0.0297419927082955, 0.0420706846219088, 0.0165183259606627, 0.0299087548961064, 0.0261736992147884, 0.0372731072295989, 0.0242170435376465, 0.0219212967702852, 0.0267094447543578, 0.0271357840725353, 0.0350166856909969, 0.0258161573271666, 0.0359925992587315, 0.0188985717748957, 0.0235316027953688, 0.0280066999340696, 0.0126051216585827, 0.0332262713927775, 0.0112095306560929, 0.0115126347851141, 0.0086934321027781, 0.0216119128745049, 0.014029106091974, 0.0185240002714895, 0.01308923761826, 0.020975890003943, 0.0101141404759671, 0.0173458548295976, 0.0110236345540865, 0.0291914840761039, 0.0314807530958205, 0.0361976026158247, 0.0382189249752887],
#     'Test loss':[0.5930132120847702, 0.4875960722565651, 0.5039553195238113, 0.4528853818774223, 0.4355150088667869, 0.4406791925430298, 0.4202819317579269, 0.4453591406345367, 0.364767387509346, 0.4474448785185814, 0.4047795534133911, 0.4504925385117531, 0.388540156185627, 0.5180482566356659, 0.4043609499931335, 0.4388785064220428, 0.4482601284980774, 0.4729906246066093, 0.6044212281703949, 0.461168110370636, 0.5961211025714874, 0.5102530419826508, 0.5820726156234741, 0.5946208387613297, 0.6534962803125381, 0.6273593232035637, 0.6317964792251587, 0.5736605823040009, 0.6248479634523392, 0.6942498981952667, 0.5934007614850998, 0.6109147816896439, 0.5662775784730911, 0.5941388010978699, 0.6601933389902115, 0.7793160974979401, 0.5942946448922157, 0.6804604530334473, 0.6051440164446831, 0.7236369252204895, 0.6246316209435463, 0.629211813211441, 0.6578809097409248, 0.6651944518089294, 0.6074420064687729, 0.6492647230625153, 0.6122041940689087, 0.5940364822745323, 0.609313540160656, 0.7182160243391991, 0.5970434471964836, 0.6954473480582237, 0.6692087352275848, 0.6675038039684296, 0.5987227037549019, 0.6997227072715759, 0.6509468629956245, 0.8207241296768188, 0.7022616863250732, 0.9341428726911544, 0.8211350291967392, 0.8944784998893738, 0.8089767545461655, 0.7704379707574844, 0.814948320388794, 0.6960778012871742]
# }

# seed = "averaged"
# noise = "noise_0.0"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 12.0, 14.0, 16.0, 18.0, 20.0, 22.0, 24.0, 26.0, 28.0, 30.0, 32.0, 34.0, 36.0, 38.0, 40.0, 42.0, 44.0, 46.0, 48.0, 50.0, 52.0, 54.0, 56.0, 58.0, 60.0, 62.0, 64.0, 66.0, 68.0, 70.0, 72.0, 74.0, 76.0, 78.0, 80.0, 82.0, 84.0, 86.0, 88.0, 90.0, 92.0, 94.0, 96.0, 98.0, 100.0, 110.0, 120.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0],
#     'Train loss':  [0.5830820862736021, 0.5004410246121032, 0.4703136943280697, 0.44984025268682404, 0.4173730779439211, 0.38504523783922195, 0.36037731862493916, 0.34259990176984234, 0.319847755799336, 0.31530689261853695, 0.2618507949103202, 0.24883373188120977, 0.22513135788696148, 0.1980765094049274, 0.1765027968212962, 0.13249946694954162, 0.14615742223603378, 0.10237431007304361, 0.11714698281139133, 0.09091424025661708, 0.09791255369782445, 0.07989018859474785, 0.0867498893057927, 0.0743581871169486, 0.060022846080495774, 0.06690090751674554, 0.06345317141884667, 0.046022622979113, 0.03621260242237305, 0.042039732486175874, 0.03162964109963335, 0.0348114513326436, 0.0264411806794149, 0.028538340885591252, 0.030117479219500476, 0.03388236663470573, 0.02898226088810975, 0.03125993272988122, 0.0270496371501524, 0.025133908925844023, 0.021980735032619575, 0.023048689547327448, 0.022983542277610673, 0.023317872887543774, 0.022730791425731523, 0.02721610117337795, 0.018842857963006374, 0.01896262569269825, 0.022712321956143023, 0.013711973326280649, 0.01911378236919902, 0.0129143607503335, 0.014751922341279776, 0.013198301684626875, 0.0156744521976049, 0.013035632580535323, 0.012158115003590549, 0.013008168360101924, 0.016223228879555622, 0.01283404428561745, 0.018918893098348825, 0.019018452009601873, 0.031006829226888372, 0.0337805976243024, 0.032203451331172625, 0.028368179071029325],
#     'Test loss':  [0.5936774909496307, 0.5203136801719666, 0.49525466561317444, 0.4690895564854145, 0.4498422257602214, 0.4222830682992935, 0.4286428056657314, 0.4373354893177748, 0.3905728626996279, 0.43367043510079384, 0.41331223398447037, 0.42157813534140587, 0.48326074331998825, 0.43523761071264744, 0.45895164273679256, 0.523004712536931, 0.4900211002677679, 0.5531740598380566, 0.511826153844595, 0.5037606749683619, 0.5229362025856972, 0.570277102291584, 0.5389222912490368, 0.5803372822701931, 0.6114494688808918, 0.5543683208525181, 0.5774228908121586, 0.6225262768566608, 0.6225669346749783, 0.5780385676771402, 0.6547339726239443, 0.6471121236681938, 0.6166288331151009, 0.6699820458889008, 0.6474334485828876, 0.6511952355504036, 0.6206702552735806, 0.649494769051671, 0.66371750831604, 0.6510784067213535, 0.6370419263839722, 0.6923066526651382, 0.624328751116991, 0.6221346668899059, 0.6308690868318081, 0.6346065476536751, 0.6772252656519413, 0.6790465693920851, 0.6304444093257189, 0.6719325222074986, 0.724158363416791, 0.6920128706842661, 0.643952451646328, 0.6788415312767029, 0.6473977342247963, 0.6918664239346981, 0.6884556524455547, 0.7199284918606281, 0.7263271417468786, 0.7906188555061817, 0.7739484757184982, 0.8245549015700817, 0.7494891760870814, 0.7202970813959837, 0.7983001079410315, 0.7996249664574862]
# }


# seed = "averaged"
# noise = "noise_0.20"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 12.0, 14.0, 16.0, 18.0, 20.0, 22.0, 24.0, 26.0, 28.0, 30.0, 32.0, 34.0, 36.0, 38.0, 40.0, 42.0, 44.0, 46.0, 48.0, 50.0, 52.0, 54.0, 56.0, 58.0, 60.0, 62.0, 64.0, 66.0, 68.0, 70.0, 72.0, 74.0, 76.0, 78.0, 80.0, 82.0, 84.0, 86.0, 88.0, 90.0, 92.0, 94.0, 96.0, 98.0, 100.0, 110.0, 120.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0],
#     'Train loss':  [0.6175446334694114, 0.5778634612049375, 0.55731031005936, 0.5331604116197143, 0.5094436505543334, 0.49348237338875023, 0.4784131590276956, 0.4627660936010735, 0.45009761516536984, 0.4401256370225123, 0.40638571711523197, 0.3666560011250632, 0.3444082579974618, 0.31770512847495924, 0.31304843604032484, 0.28339120798877304, 0.26760733686387533, 0.26107139579419575, 0.2371859700818147, 0.20230888315875611, 0.19297734794339955, 0.2141045024618506, 0.19242359544815757, 0.17292415636724656, 0.15739818083654555, 0.16055466487471542, 0.1457892783717917, 0.14056309964507813, 0.1458092505178813, 0.1400572394153901, 0.12264290641594143, 0.10682816913218365, 0.09406832339508187, 0.08769628844623047, 0.1248465220310858, 0.0904205763779048, 0.08619729489354144, 0.08978579085253707, 0.08248293632641428, 0.07138497269313247, 0.08486799599735857, 0.08620097752593986, 0.08612449583597478, 0.06863830602794346, 0.0706696273492915, 0.07642274642629278, 0.06494118951793225, 0.0581056067520486, 0.06541396614297156, 0.05610651947790753, 0.05243072202262865, 0.060142528714745125, 0.04564845779844158, 0.053020584430279426, 0.0395003431559806, 0.04491719216873333, 0.04003874657376265, 0.04879068564956205, 0.04904166401164335, 0.05778671321292802, 0.07095767689004003, 0.06657650903798633, 0.09642178335759251, 0.07305390349522763, 0.08754448546096677, 0.07695762703328254],
#     'Test loss': [0.5948484800755978, 0.5369379110634327, 0.5145613737404346, 0.4879591800272465, 0.4663936551660299, 0.45765763334929943, 0.448194719851017, 0.4506797827780247, 0.4400826133787632, 0.4322335533797741, 0.4234893433749676, 0.4448672700673342, 0.4699707701802254, 0.47386052645742893, 0.4634220227599144, 0.4628366529941559, 0.46462645567953587, 0.5052225105464458, 0.5309529285877943, 0.5365412514656782, 0.5911019705235958, 0.5492257475852966, 0.5646879486739635, 0.5879617314785719, 0.6600628774613142, 0.5785580221563578, 0.6607786379754543, 0.6314260568469763, 0.6141065992414951, 0.5920007172971964, 0.6355152502655983, 0.681831719353795, 0.6707263235002756, 0.7591759786009789, 0.6630045212805271, 0.752540547400713, 0.7240462303161621, 0.7282815799117088, 0.7512996606528759, 0.7991470396518707, 0.6799268387258053, 0.7255768422037363, 0.7186949402093887, 0.758515290915966, 0.7149082981050014, 0.7264340668916702, 0.7798184845596552, 0.7948483694344759, 0.7408391162753105, 0.76338766887784, 0.8058561272919178, 0.732755308970809, 0.8170631527900696, 0.8152453973889351, 0.8746528401970863, 0.7465965673327446, 0.8940139599144459, 0.8413891233503819, 0.8936185687780379, 1.0041028782725334, 0.8984627835452557, 0.9284167233854532, 0.9104693792760372, 0.9326447956264019, 0.8691759072244167, 0.989062026143074]
# }


######################################################################################################################
# PROTEINS

# seed = "43"
# noise = "noise_0.0"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [0.6574377343058586, 0.5890060216188431, 0.555087998509407, 0.5442183837294579, 0.6018849760293961, 0.5602602735161781, 0.5368705838918686, 0.513127539306879, 0.4972344599664211, 0.4920962788164615, 0.4869382083415985, 0.5840287543833256, 0.5051041916012764, 0.5862294994294643, 0.4099053554236889, 0.4537135884165764, 0.5081935971975327, 0.5385696142911911, 0.4665786884725094, 0.5297822691500187, 0.428774781525135, 0.4836238324642181, 0.4421919956803322, 0.4346013702452183, 0.488270778208971, 0.4675845168530941, 0.4408956691622734, 0.4680601581931114, 0.4806968905031681, 0.4193429760634899, 0.4431366734206676, 0.3935426957905292, 0.4972816258668899, 0.4316152110695839, 0.4681721962988376, 0.384845171123743, 0.4483149386942386, 0.3922014124691486, 0.3618512488901615, 0.4068431183695793, 0.4541618749499321, 0.4240133911371231, 0.393499594181776, 0.4482169337570667, 0.3918416425585747, 0.3982621505856514, 0.3654824160039425, 0.4987433403730392, 0.4226552993059158, 0.4146751463413238, 0.4371104054152965, 0.4981652088463306, 0.4451232925057411, 0.5226040668785572, 0.445831336081028, 0.4147085361182689, 0.4984025992453098, 0.4439237639307976, 0.4962945394217968, 0.4718947745859623, 0.4460839368402958, 0.5232468247413635, 0.4881025478243828, 0.5237305760383606, 0.5673554539680481, 0.5527550764381886],
#     'Test loss':[0.6785368323326111, 0.6783612370491028, 0.6567521095275879, 0.6070587038993835, 0.6644567847251892, 0.6281941533088684, 0.6527131199836731, 0.6471946835517883, 0.5925776362419128, 0.632249653339386, 0.69727623462677, 0.6310359835624695, 0.6163702607154846, 0.6730067133903503, 0.6724410653114319, 0.6901218295097351, 0.6896974444389343, 0.6480588316917419, 0.6989014744758606, 0.6894989013671875, 0.6639734506607056, 0.6605080962181091, 0.6786617040634155, 0.7467597723007202, 0.6369818449020386, 0.7139452695846558, 0.7285606265068054, 0.6472950577735901, 0.6939188241958618, 0.7101799845695496, 0.7146410942077637, 0.7614713311195374, 0.6784358024597168, 0.6740463972091675, 0.6873589754104614, 0.7558645009994507, 0.7007887959480286, 0.730575680732727, 0.7289644479751587, 0.7291584610939026, 0.6658282279968262, 0.7272023558616638, 0.7064031958580017, 0.664520800113678, 0.7018251419067383, 0.72589510679245, 0.6728655099868774, 0.6965919733047485, 0.7011500000953674, 0.6953704953193665, 0.7197937369346619, 0.6891012787818909, 0.6825178861618042, 0.7490668892860413, 0.6385306119918823, 0.6976758241653442, 0.7734269499778748, 0.6797072291374207, 0.6484969854354858, 0.6348041892051697, 0.6378236413002014, 0.6360527873039246, 0.6448820233345032, 0.623888373374939, 0.6087640523910522, 0.632687509059906]
# }

# seed = "43"
# noise = "noise_0.20"
# dataset = "PROTEINS"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [0.6516756638884544, 0.601124968379736, 0.5969288945198059, 0.5710520446300507, 0.5947555154561996, 0.5397737473249435, 0.5603834763169289, 0.5849839895963669, 0.5461243987083435, 0.601220790296793, 0.5508039407432079, 0.5693210810422897, 0.5267803408205509, 0.5999898090958595, 0.4982953481376171, 0.533190380781889, 0.5423309803009033, 0.6041154526174068, 0.5422695241868496, 0.5505269393324852, 0.5328236445784569, 0.5047696121037006, 0.559370867908001, 0.4936320893466472, 0.465098962187767, 0.5336384400725365, 0.4931642189621925, 0.5670363269746304, 0.5074935890734196, 0.4582191817462444, 0.4906732179224491, 0.4528999514877796, 0.5347599536180496, 0.4975609220564365, 0.5245483666658401, 0.4502927623689174, 0.5074106343090534, 0.4945847131311893, 0.4928257875144481, 0.430049329996109, 0.4928073585033417, 0.508487656712532, 0.4751585051417351, 0.4650975130498409, 0.4762922562658787, 0.5331068970263004, 0.4903239011764526, 0.5150647424161434, 0.4978409558534622, 0.5075330287218094, 0.5002862066030502, 0.59259919449687, 0.5356220714747906, 0.5986943542957306, 0.4826701991260052, 0.455437358468771, 0.5566483214497566, 0.5020361058413982, 0.5863381922245026, 0.511264979839325, 0.5361656285822392, 0.6127321124076843, 0.5672783181071281, 0.5423676036298275, 0.610665075480938, 0.5707371048629284],
#     'Test loss':[0.6666712760925293, 0.634313702583313, 0.6382891535758972, 0.593869149684906, 0.676382839679718, 0.6674845814704895, 0.6478530764579773, 0.6355960965156555, 0.63337242603302, 0.6968178749084473, 0.6023135781288147, 0.6559299826622009, 0.5945366621017456, 0.6195658445358276, 0.6039543151855469, 0.6667546033859253, 0.6488922834396362, 0.6419122815132141, 0.6633262634277344, 0.7228782773017883, 0.5838990211486816, 0.7038119435310364, 0.6875986456871033, 0.6700631976127625, 0.6253334879875183, 0.6466073393821716, 0.6070801615715027, 0.6601495146751404, 0.7132604718208313, 0.6833367943763733, 0.6512808799743652, 0.7105786204338074, 0.6978062391281128, 0.6623669266700745, 0.6671211123466492, 0.727291464805603, 0.6577672958374023, 0.6428714394569397, 0.6253786683082581, 0.7331221699714661, 0.6705445647239685, 0.6746464967727661, 0.6474627256393433, 0.6534618735313416, 0.733627438545227, 0.6511402726173401, 0.6549648642539978, 0.6488138437271118, 0.6281886100769043, 0.6541093587875366, 0.6350070238113403, 0.64365154504776, 0.6589840054512024, 0.6712369918823242, 0.6448771357536316, 0.7048083543777466, 0.6382261514663696, 0.6274045705795288, 0.613551914691925, 0.631851315498352, 0.6131063103675842, 0.5939982533454895, 0.5954362154006958, 0.5900532603263855, 0.6044729351997375, 0.5994921326637268]
# }



######################################################################################################################
# ENZYMES

# seed = "41"
# noise = "noise_0.20"
# dataset = "ENZYMES"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss':  [1.8057243824005127, 1.7138633131980896, 1.7011259496212006, 1.6731882095336914, 1.6175893247127533, 1.5250236690044403, 1.5196203291416168, 1.443370521068573, 1.3245786428451538, 1.4521404504776, 1.3064855337142944, 1.2694615423679352, 0.9624271541833878, 0.995333269238472, 0.6581355780363083, 0.9920961260795592, 0.8144532740116119, 0.9247507750988008, 0.5996568948030472, 0.5939172059297562, 0.3013703264296055, 0.6418358236551285, 0.2396943271160125, 0.1278784517198801, 0.1734093800187111, 0.1033917926251888, 0.2298173382878303, 0.2464098669588565, 0.0988114140927791, 0.3026264309883117, 0.149009134620428, 0.0872362470254302, 0.1003688238561153, 0.0934729725122451, 0.0596529757604002, 0.0776290986686945, 0.0823598746210336, 0.1017733495682478, 0.0375501210801303, 0.0496323248371481, 0.0351852695457637, 0.0377030451782047, 0.0581660009920597, 0.0548204313963651, 0.0500356443226337, 0.048685323446989, 0.0467360755428671, 0.0344078196212649, 0.0326761067844927, 0.0385864432901144, 0.0449295928701758, 0.0187527805101126, 0.0307611273601651, 0.0268037123605608, 0.0178839908912777, 0.0207464622799307, 0.023881115950644, 0.0128665338270366, 0.0075283824698999, 0.0119008142501115, 0.0108387825312092, 0.014360383618623, 0.0154966068221256, 0.017498597735539, 0.0246283602900803, 0.0234627372119575],
#     'Test loss': [1.835302710533142, 1.8952454328536987, 1.94603168964386, 1.8876893520355225, 1.8920565843582156, 1.78239643573761, 1.945206999778748, 1.854819655418396, 1.801513433456421, 1.9745080471038816, 1.842288851737976, 1.993659496307373, 1.922030568122864, 1.7435318231582642, 1.9047366380691528, 1.833011507987976, 1.866596817970276, 1.7920385599136353, 1.7601035833358765, 1.865928173065185, 2.343071699142456, 1.8529760837554927, 2.09334659576416, 2.4210002422332764, 2.177117347717285, 2.445484161376953, 2.0231661796569824, 1.992464303970337, 2.127450466156006, 2.0687906742095947, 2.204867362976074, 2.152254819869995, 2.2930078506469727, 1.913576364517212, 2.303391218185425, 2.347712755203247, 2.21610951423645, 1.905484676361084, 2.379071950912476, 2.4319043159484863, 2.2730493545532227, 2.451432943344116, 2.567003965377808, 2.2136197090148926, 2.378998041152954, 2.2614996433258057, 2.3857266902923584, 1.8985990285873413, 2.2456846237182617, 2.1797571182250977, 2.186603546142578, 2.3479466438293457, 2.106220245361328, 2.221972703933716, 2.1040732860565186, 2.4340600967407227, 2.3057854175567627, 2.2314352989196777, 2.7290358543396, 2.758696794509888, 2.6904046535491943, 2.644354820251465, 2.830204963684082, 2.600849151611328, 2.435733795166016, 2.725343942642212]
# }

# seed = "41"
# noise = "noise_0.0"
# dataset = "ENZYMES"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000],
#     'Train loss':[1.786573976278305, 1.748755723237991, 1.6873497366905212, 1.673527330160141, 1.5140933096408844, 1.415912926197052, 1.259431540966034, 1.369701087474823, 1.2905492782592771, 1.2011060416698456, 0.7905301153659821, 0.7312130182981491, 0.504454493522644, 0.624719113111496, 0.6652013063430786, 0.704984501004219, 0.6710805743932724, 0.3922076523303985, 0.452705517411232, 0.2750360742211342, 0.1571095753461122, 0.1097488068044185, 0.2562496922910213, 0.1805365160107612, 0.1360549554228782, 0.0781570430845022, 0.1807157322764396, 0.0676004653796553, 0.0580428848043084, 0.0778778120875358, 0.0904654907062649, 0.0300433756783604, 0.0516859665513038, 0.0345812854357063, 0.0348829794675111, 0.0217921119183301, 0.0327355619519948, 0.0566801498644053, 0.0336495754308998, 0.0263777407817542, 0.021471073385328, 0.0292005110532045, 0.0205434104427695, 0.0172115925233811, 0.0131588985677808, 0.0241378592327237, 0.0169746852479875, 0.0130119181703776, 0.0234182132408022, 0.0233467738144099, 0.0161085992585867, 0.0122747577261179, 0.0081154316430911, 0.0101145091466605, 0.0133556149667128, 0.0056796612916514, 0.0054594200919382, 0.0035798668977804, 0.0026639938005246, 0.0065473136492073, 0.0042351912125013, 0.0037193717435002, 0.0047234286903403, 0.004759483388625, 0.0088161864550784, 0.0100845161359757, 0.0084828791441395, 0.0064061911543831, 0.0070960223674774, 0.0086030740058049, 0.0259047602303326, 0.0091907200403511],
#     'Test loss': [1.788957595825195, 1.857816696166992, 1.745598554611206, 1.793018460273743, 1.6462368965148926, 1.7884604930877686, 1.523066759109497, 1.674551010131836, 1.5690696239471436, 1.7325268983840942, 1.754835844039917, 1.5728793144226074, 1.8583908081054688, 1.8336519002914429, 1.5213793516159058, 1.5572645664215088, 1.5973141193389893, 1.4833558797836304, 1.7557246685028076, 1.8738571405410769, 1.9824795722961424, 1.9271619319915767, 1.792014718055725, 1.9009311199188232, 1.8929029703140257, 1.9338356256484983, 1.6569830179214478, 1.582092523574829, 1.7032769918441772, 1.888465881347656, 1.5463865995407104, 2.101737260818481, 1.6911872625350952, 1.8463313579559328, 1.8011256456375122, 1.93875253200531, 2.0447747707366943, 1.991058588027954, 1.835120677947998, 1.6452306509017944, 2.2605984210968018, 1.610163927078247, 2.104670763015747, 1.8224412202835083, 1.711336612701416, 1.8728779554367063, 2.04965877532959, 1.7520960569381714, 1.7065733671188354, 1.8506903648376465, 1.7760852575302124, 2.091273069381714, 2.0050976276397705, 2.016970634460449, 1.7472801208496094, 1.8425805568695068, 2.175341844558716, 2.084625005722046, 1.9448240995407104, 1.9197560548782349, 1.9249451160430908, 2.272421598434448, 1.7922561168670654, 2.004779815673828, 2.008674383163452, 1.9340204000473025, 2.003507375717163, 1.949622750282288, 1.870810627937317, 1.8839737176895144, 2.114463806152344, 1.9239840507507324]
# }



######################################################################################################################
# NCI1
# seed = "41"
# noise = "noise_0.0"
# dataset = "NCI1"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 90, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss':[0.6281348892620632, 0.5705437596355166, 0.5234122116650853, 0.4995451835649354, 0.4510808980890682, 0.4176947346755436, 0.359698694731508, 0.3156027942895889, 0.2966898887285164, 0.291509674595935, 0.2101788323904787, 0.1339053163038832, 0.1697405177567686, 0.1452396993658372, 0.083389417667474, 0.0887182279090796, 0.0607691360637545, 0.0602111936812954, 0.0470226993784308, 0.0342606683261692, 0.0277472427114844, 0.0300580531558288, 0.0188258889497124, 0.0165979548224381, 0.0154083476102511, 0.0099430192910533, 0.0091009136023265, 0.0106671265675686, 0.0090255938370579, 0.0121650450081298, 0.0082394371981666, 0.0059101150088411, 0.0061512606459603, 0.0067990952021708, 0.0060028748204266, 0.0085699778781937, 0.0071045074478856, 0.0083144182613718, 0.0046848443681873, 0.0068027730864871, 0.0064159181700753, 0.0065768926080116, 0.0072973965517511, 0.0060563973383978, 0.0059595274942694, 0.0046946237957204, 0.0053294391629086, 0.0040093529574473, 0.006442701547972, 0.0044409725544807, 0.0043945456917364, 0.0048399076393772, 0.0054726503273871, 0.0047931736106485],
#     'Test loss': [0.603484719991684, 0.5953128188848495, 0.5443118959665298, 0.5102481469511986, 0.4953537955880165, 0.5154709070920944, 0.4947817996144295, 0.4928482696413994, 0.5250717476010323, 0.5377118140459061, 0.5763364434242249, 0.6783648431301117, 0.5793411880731583, 0.6850481182336807, 0.5925414934754372, 0.6035723090171814, 0.7757268846035004, 0.6791596859693527, 0.846737302839756, 0.7921148091554642, 0.9260497242212296, 0.8732893317937851, 0.8525472283363342, 0.7726071029901505, 0.8229392170906067, 0.8478043228387833, 0.8880033642053604, 0.9200827479362488, 1.0160579234361649, 0.949719101190567, 0.8772905319929123, 0.8624533265829086, 1.1423299014568329, 0.8282276690006256, 0.9363907426595688, 0.8412201926112175, 1.1558142304420471, 1.0716270506381989, 1.0995959788560867, 0.9206617325544356, 0.9478081911802292, 0.9861912727355956, 0.8719814866781235, 0.8545067459344864, 0.8898938149213791, 0.8849094808101654, 0.9655208140611647, 1.0433099567890167, 0.9186003804206848, 1.0364388674497604, 1.3918311595916748, 1.3780045807361605, 1.307996615767479, 1.2351626455783844]
# }

seed = "41"
noise = "noise_0.20"
dataset = "NCI1"
method = "adam_0.001"
data_last_epoch = {
    'Hidden Dimensions': [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 90, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
    'Train loss': [0.6475582420825958, 0.6414987338440759, 0.579011829836028, 0.546535561127322, 0.5112113175647599, 0.4788447288530214, 0.4671260757105691, 0.4367225968411991, 0.4049638169152396, 0.3724672655974115, 0.3420621284416744, 0.3263325531567846, 0.2653596230915614, 0.2326453902891704, 0.2174225337803363, 0.1356259690863745, 0.1331359368882008, 0.1473111039293664, 0.0829264924728444, 0.089355486711221, 0.0662862671805279, 0.0611438847013882, 0.0473985173074262, 0.0438088301037039, 0.0483338455669581, 0.0474223791222487, 0.0410607138515583, 0.0480910067978714, 0.0370735470205545, 0.0271294279622712, 0.0291287400427141, 0.0380424469310258, 0.0304339681086795, 0.0225022166435207, 0.0280995207306529, 0.0301534399456743, 0.0204596716711031, 0.0234501311123105, 0.0222078111089233, 0.025825654156506, 0.0191709604114294, 0.0178413247257205, 0.0215046057544116, 0.0225257541917796, 0.0129358983498864, 0.0111515256659393, 0.0112011619660604, 0.0119811830809339, 0.0147362706983195, 0.0103150248926665, 0.0173202496703847, 0.0131377528471473, 0.0173049866820552, 0.0154759329411068],
    'Test loss': [0.6116117984056473, 0.6230970025062561, 0.5507771521806717, 0.5017998367547989, 0.5125908628106117, 0.4817046225070953, 0.5271953418850899, 0.4780752137303352, 0.5075135976076126, 0.4918132200837135, 0.5284579992294312, 0.5297367721796036, 0.6181989312171936, 0.5880807712674141, 0.5511850193142891, 0.7201745361089706, 0.6018944457173347, 0.7103817909955978, 0.8515830636024475, 0.722974456846714, 0.898183062672615, 0.8465427532792091, 0.9670659750699996, 0.9980151653289796, 0.8989965170621872, 0.8896794021129608, 0.7875555902719498, 0.9241733103990556, 0.9962857365608216, 1.041242629289627, 0.8677496463060379, 1.011512115597725, 0.9764090105891228, 0.9960097670555116, 1.0548659712076187, 0.9860104471445084, 1.0570737719535828, 0.8613573610782623, 1.046506866812706, 0.9345469772815704, 0.9489859789609908, 1.0717439502477646, 1.2428205460309982, 1.0377741754055023, 1.062370464205742, 1.19370236992836, 1.223796471953392, 1.1844354271888733, 1.3758705258369446, 1.22627092897892, 1.4165995717048645, 1.5689276158809662, 1.0564476251602173, 1.3988242149353027]
}


df_last_epoch = pd.DataFrame(data_last_epoch)

df_last_epoch.to_csv(f'{dataset}/{noise}/{seed}/loss_{method}.csv', index=False)
# df_last_epoch.to_csv(f'misc/sgd_loss.csv', index=False)

# Plot the data
plt.figure(figsize=(15, 8))
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Train loss'], marker='o', label='Train Loss', color='red')
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Test loss'], marker='o', label='Test Loss', color='blue')
plt.title('Results - loss curves - last epoch')
plt.xlabel('Hidden Dimensions')
plt.ylabel('Loss')
plt.legend()
# plt.xticks(df_last_epoch['Hidden Dimensions'])
plt.xticks(range(0, 1100, 50), fontsize=10)
plt.grid(True)
plt.tight_layout() 
plt.savefig(f'{dataset}/{noise}/{seed}/loss_{method}.png')  # Save the plot as an image file
# plt.savefig(f'misc/sgd_loss.png')  # Save the plot as an image file