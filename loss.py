import pandas as pd
import matplotlib.pyplot as plt

import pandas as pd
import matplotlib.pyplot as plt

# method = "adam_0.001"

# MNIST 
dataset = "mnist"

# noise = "noise_0.10"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 14, 16, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.015533615822016, 1.837614319213601, 1.7239973173585048, 1.5122895969900974, 1.4254723803941594, 1.2126625036084375, 1.1248138883779215, 1.081358722476072, 1.079263536597407, 0.905012200322262, 0.8105312862368517, 0.7909110803936803, 0.7303768550240717, 0.6493857238181802, 0.5852782794209413, 0.5560919663933821, 0.4528858912199042, 0.3757914548003396, 0.3324512548917948, 0.2652582562246988, 0.175237061014009, 0.0939841959365578, 0.0821773331222492, 0.0086468360088982, 0.0150735480987012, 0.0072494684033593, 0.0033373297694366, 0.0006470163442975, 0.0011575854724871, 0.0004700511195466, 0.000507088198897, 0.0003764362584767, 0.0002682917103896, 0.0001705604908978, 5.999444176141392e-05, 6.806277890994585e-05, 7.911211812740454e-05, 3.672764165817488e-05, 2.08867499691752e-05, 1.3936125429439884e-05, 1.4280208033543986e-05, 1.0488828100669918e-05, 2.174319324443638e-06, 1.0458258147205174e-06, 4.37513979369045e-07, 4.26578341204525e-07, 2.758312126963156e-07, 2.1144057095784245e-07, 1.7682312531808702e-07, 5.301796564149458e-07],
#     'Test loss':[2.0176196219045903, 1.8191817350025417, 1.7022397457798826, 1.5125563386120373, 1.3881235899804514, 1.1898623984071273, 1.1176370329494718, 1.109501245655591, 1.0710887410972691, 0.9331489288354222, 0.856735993035232, 0.8498582836193375, 0.8297106499158884, 0.8316667113877549, 0.8707132705404789, 0.8799950454054, 1.0203340743915943, 1.156568836562241, 1.222476463529128, 1.3796254117277604, 1.68861787832236, 1.961037827443473, 1.94144070148468, 2.675202052804488, 2.634767162648937, 2.727253431006323, 2.84424625921853, 3.0555781231650823, 3.0244792895981027, 3.010259501541717, 2.9596553739113145, 2.9899406236938284, 3.0314320853993864, 3.065724505653864, 3.024669090403786, 3.010949834992614, 3.0597377653363385, 3.0421895045268386, 3.031314821182927, 3.091067784949194, 3.090935681439653, 3.127355127394954, 3.0967214967631085, 3.198875051510485, 3.2788058142118817, 3.273591433899312, 3.2897664218009277, 3.292920924440215, 3.403544296192217, 3.2230093101911907]
# }

# others 
# method = "sgd_0.01_0.9"
# noise = "noise_0.20"
# data_last_epoch = {
#     'Hidden Dimensions':[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 50, 55, 60, 70, 80, 90, 100, 120, 140, 150, 160, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.087906659758368, 1.9596371808717417, 1.8350112285724909, 1.7130131860112034, 1.6540922630664914, 1.60186520925788, 1.5550309968549152, 1.4480594399363496, 1.389087557515433, 1.4112541265265883, 1.2859010980572811, 1.2124028409636298, 1.1838590971259184, 1.1429361063380574, 1.14884710880213, 1.1204827736976537, 1.089011063409406, 1.0056194229181423, 0.9998903978702632, 0.962362890742546, 0.8949141294457191, 0.932188491488612, 0.8051454320896504, 0.7981964306775914, 0.668021372723025, 0.6006130356428235, 0.3854027338152708, 0.4098108103802038, 0.3443878648586051, 0.2255391632055127, 0.0453551449834607, 0.0393352930325754, 0.0142783024229195, 0.0090275165570769, 0.0062023547136896, 0.0049329300898365, 0.004242776751215, 0.0040338616736969, 0.0023254649751538, 0.0020304464683651, 0.0020507084971921],
#     'Test loss':[2.088586102558088, 1.957440907442117, 1.83087844486478, 1.7142444396320775, 1.6514828657802147, 1.6011863660208787, 1.5545580681366256, 1.4513312140597572, 1.4012163409703895, 1.4232776979856854, 1.2978272362600398, 1.2486062283757366, 1.2210228322427483, 1.1976541484458536, 1.21100205333927, 1.1943292165104349, 1.1915685700464853, 1.1940276049360443, 1.1934467403194573, 1.2344428693191916, 1.273691796049287, 1.2217361889308012, 1.3416268682178063, 1.3629289314716675, 1.504166141341004, 1.5691861910156055, 1.904091294807724, 1.8331404698045948, 1.884454933902885, 2.0421702318553683, 2.719790934007379, 2.68209461924396, 2.8541454710537875, 2.6741508456725107, 2.6454083904435364, 2.6021331941025165, 2.5432619429841825, 2.5116860504391827, 2.556232885469364, 2.5986800510672072, 2.618330760847164]
# }

######################################################################################################################
# CIFAR10 

# dataset="cifar10"

# noise = "noise_0.0"
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 25, 30, 35, 40, 45, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 155, 200, 300, 500, 600, 700, 800, 900, 1000],
#     'Train loss':[2.088652094656771, 1.921666229990396, 1.8504936278543689, 1.751878629692576, 1.703234439207749, 1.623055856336247, 1.5991047935729676, 1.5240627296946263, 1.4998935549096628, 1.4739042347805067, 1.357667434621941, 1.311247892677784, 1.2642062208191915, 1.234261015938087, 1.1746550359847872, 1.1748074812983924, 1.1062869727611542, 0.9505404631861232, 0.8852150966836647, 0.7741396715017882, 0.7455991211939942, 0.5217971563000571, 0.378751103893261, 0.2573590323074974, 0.1717037213754586, 0.1242830485888672, 0.1143903595882214, 0.06866811781021, 0.0336373863723234, 0.0208567172786305, 0.0146781387222951, 0.0125667967427447, 0.005932896658454, 0.0037490732217768, 0.0035269479834493, 0.0026963514936307, 0.0018014741689181, 0.0011051871177766, 0.0009847172729099, 0.0006031556006291, 0.0003716708550675, 0.0001028838830476, 2.582415341188173e-05, 9.428813951343914e-06, 5.818499395101898e-06, 5.024333183198141e-06, 4.002200097391102e-06, 4.17063199491126e-06, 4.404556896663404e-06],
#     'Test loss': [2.081921698171881, 1.9160759101940104, 1.8451510079299347, 1.7312518373320374, 1.718138791337798, 1.612104524539996, 1.6152343568922598, 1.5401702817482283, 1.5200082893613018, 1.479970348032215, 1.4054747774631162, 1.3804342112963712, 1.3483881467505343, 1.351209702371042, 1.3356649739832818, 1.3521278447742704, 1.3029018768781349, 1.3652484748936906, 1.3936037881464898, 1.560463028618052, 1.5028805461110948, 1.851388558556762, 2.0571374666841726, 2.357060098949867, 2.656457603732242, 2.979140954681589, 2.937795240667802, 3.148790392694594, 3.467621350590187, 3.5699810800673086, 3.7156940774072575, 3.799126148223877, 4.073057198826271, 3.864559997486163, 3.914963000937353, 3.8549122689645503, 3.950045600722108, 4.082204945479767, 4.096460656274723, 4.056628933435754, 4.05681978298139, 4.093354593349408, 3.949212958541097, 3.773733268810224, 3.759704541556443, 3.733867835394944, 3.715147489233862, 3.713838918299615, 3.6449283346345154]
# }

# noise = "noise_0.10"    
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30, 32, 35, 40, 45, 50, 55, 60, 64, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 128, 130, 135, 140, 145, 200, 256, 300, 400, 512, 600, 700, 800, 900, 1000],
#     'Train loss':[2.1417064849625933, 1.998686808076772, 1.9694648300382225, 1.8940174132585528, 1.8745401864024729, 1.8136846782131628, 1.7656417590650646, 1.7424287318506024, 1.7095086141066118, 1.669380278072574, 1.615083288740028, 1.5627141638912938, 1.5233345803889362, 1.4956116266548634, 1.4634385867552324, 1.3801303262060338, 1.2768064876171676, 1.2476500547067686, 1.1912746507335792, 1.1274677410044454, 1.052069106054577, 0.9263710531998764, 0.819187989119779, 0.7165211832828142, 0.642997526563704, 0.5115102781829509, 0.42387435445562, 0.3672078728083182, 0.2433970227033238, 0.1839592199222269, 0.0833201304247433, 0.0550927555887028, 0.0371848898357711, 0.0222863626020791, 0.013355688504155, 0.0097018278224409, 0.0065882698108907, 0.0036612245292582, 0.0059960663093079, 0.0027180056970544, 0.002988885210057, 0.0024378193924845, 0.0001974223607961, 5.871168435657058e-05, 4.112228675849524e-05, 1.3324781163377834e-05, 1.0088484493050744e-05, 5.095969851512646e-06, 8.413468165713311e-06, 4.9623024219029466e-06, 4.878874619055037e-06, 4.394976401316859e-06],
#     'Test loss': [2.133337274382386, 1.987140797361543, 1.956050125858452, 1.8758832261532168, 1.8613230835033368, 1.803558648387088, 1.7560972080955022, 1.744848396204695, 1.7062576254711876, 1.6806199927873249, 1.6500604031961177, 1.6139006388338306, 1.609555929521971, 1.6161476931994474, 1.6078180934809432, 1.6089785114119324, 1.6389274551898618, 1.599985425985312, 1.6970822554600389, 1.7610341717925253, 1.7883180394957336, 1.9170096614692784, 2.126671569256843, 2.2604485916185983, 2.3781634373000906, 2.6493192352826083, 2.8566112005257907, 3.0822872964641714, 3.567893148977545, 3.710925488532344, 4.461452988129627, 4.630279160753081, 4.90162177327313, 5.34946872614607, 5.475829984568343, 5.487114495868925, 5.7484905297243145, 5.909994970394086, 5.567079314702673, 5.8848091982587984, 5.828729701947562, 5.797602967370914, 6.068015623696243, 5.850295504437217, 5.821570680111269, 5.657618848583367, 5.622812904889071, 5.52404652667951, 5.569872433626199, 5.512833106366894, 5.486212980898121, 5.450845573521868]
# }

# noise = "noise_0.20"    
# data_last_epoch = {
#     'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss': [2.1831094182350417, 2.097308375280012, 2.064494512975216, 2.01915953443809, 1.980272962288423, 1.9290285591374745, 1.9197751073674725, 1.8485252633690836, 1.8696716089140288, 1.8250231424515897, 1.7752816765145822, 1.749801574444229, 1.715474669906226, 1.6686391891403631, 1.6453391760587692, 1.598515601659363, 1.5335412987253882, 1.415911911224777, 1.405443114651875, 1.2609785642813554, 1.1743815459988334, 1.103973396291787, 1.003716597164219, 0.8472031112760305, 0.7115029450505972, 0.6514437357810411, 0.4762692296538841, 0.3644623897800391, 0.3001939181915738, 0.1449002879460088, 0.1099104231371629, 0.0832519794613207, 0.0539070575614459, 0.0294039155798435, 0.0095276510364783, 0.0088940428375446, 0.0041841049920053, 0.0028599628311977, 0.0012379373313871, 0.0008470734497181, 0.0005061904182536, 0.0002915640360986, 0.0001358358729042, 2.331693680575468e-05, 1.7873541045270773e-05, 7.508091432452023e-06, 4.817070209384156e-06, 4.694389304595668e-06, 6.597937670963202e-06, 3.602760542262021e-06],
#     'Test loss': [2.1798473581483093, 2.08978681775588, 2.05950294416162, 2.009645440910436, 1.979845279379736, 1.9268716981139364, 1.9318107517459724, 1.8917634155176863, 1.8782191336909424, 1.8456361761576008, 1.8182006108609936, 1.7965923230859298, 1.78646783436401, 1.7994585505014733, 1.796319766889645, 1.820375404780424, 1.8413621021222464, 1.9310653617110436, 1.9274234409573712, 2.0184869404080548, 2.1513118924973886, 2.218454797056657, 2.3586879440500765, 2.621439639526077, 2.908761501312256, 2.995512219923961, 3.587300647663165, 3.9926273098474816, 4.212440807608109, 5.097677903839305, 5.279251641865018, 5.697241511525987, 6.140512037880813, 6.25652555272549, 6.904237578186808, 6.910548216179956, 7.245659882509256, 7.226821169068541, 7.322778955290589, 7.326033791409263, 7.349701386463793, 7.468631973749475, 7.217922554740423, 7.281879352617867, 7.080351310440257, 6.986111556427388, 7.0887729367123375, 6.817135919498492, 6.6814224689821655, 6.787775323360781]
# }

# seed = "41"
# noise = "noise_0.0"
# dataset = "mutagenicity"
# method = "adam_0.001"
# data_last_epoch = {
#     'Hidden Dimensions': [1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 14, 16, 18, 20, 22, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 90, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
#     'Train loss':  [0.5789380009685244, 0.4737842093620981, 0.4755757195608956, 0.4325685543673379, 0.4317615266357149, 0.3688649364880153, 0.3318187658275877, 0.3196407865200724, 0.3283297733536788, 0.2930399488125528, 0.2633864576263087, 0.2296887253011976, 0.1968369209872824, 0.1872361592416252, 0.1391470323183707, 0.1177019180197801, 0.1230244290615831, 0.0738733885144548, 0.108028237840959, 0.1144547829670565, 0.0827224275895527, 0.0791077334433794, 0.0562250270242137, 0.0714228356789265, 0.0502708667357053, 0.0607507773009794, 0.0388798191810825, 0.0468038957832115, 0.0212072595355234, 0.0288793960519667, 0.0366689350589045, 0.028291206673852, 0.0125203233578109, 0.0312586805583643, 0.0300966584389763, 0.0213956641299384, 0.042021042268191, 0.0242334865698856, 0.0182961225842258, 0.0221535214888198, 0.0111461627363626, 0.0174462853132614, 0.0184399005458025, 0.0114199182717129, 0.0142402673372998, 0.0181549161373238, 0.0151365387719124, 0.0112442054419911, 0.0167509885338534, 0.0205367362525846, 0.0187596387362905, 0.0228169449338955, 0.0296156529636521, 0.0383667026513389, 0.0278901301124798, 0.0304486445550407],
#     'Test loss':[0.5701285749673843, 0.4982378035783767, 0.5139067247509956, 0.4704031348228454, 0.4553766846656799, 0.3868169039487839, 0.4560366347432136, 0.3968914002180099, 0.4435945004224777, 0.4032083451747894, 0.4522974044084549, 0.4218545034527778, 0.4202354177832603, 0.4445005878806114, 0.5574311763048172, 0.4771700203418731, 0.5505867153406143, 0.4668575823307037, 0.5451489835977554, 0.4713874906301498, 0.5023876130580902, 0.5616699606180191, 0.6319024041295052, 0.5336385518312454, 0.6705876067280769, 0.5741195231676102, 0.5757289007306099, 0.507670097053051, 0.6477099880576134, 0.6841125786304474, 0.5735652670264244, 0.5778006613254547, 0.7113306075334549, 0.6277232766151428, 0.6187898218631744, 0.681055873632431, 0.7055519670248032, 0.6362913697957993, 0.7517076283693314, 0.6520889550447464, 0.6732692569494247, 0.5829554349184036, 0.7137271016836166, 0.6314901262521744, 0.6172655746340752, 0.6430253982543945, 0.7649897634983063, 0.7329133152961731, 0.8055959492921829, 0.7671938538551331, 0.7710115760564804, 0.8156988173723221, 0.7305807322263718, 0.7532601356506348, 0.8513428270816803, 0.7368466109037399]
# }

seed = "42"
noise = "noise_0.0"
dataset = "mutagenicity"
method = "adam_0.001"
data_last_epoch = {
    'Hidden Dimensions':  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 110, 120, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
    'Train loss':  [0.6051427551678249, 0.4868623188563755, 0.4802490419575146, 0.4610391046319689, 0.4047135966164725, 0.3924618182437761, 0.3491130588310105, 0.3318251126578876, 0.3222261864159788, 0.2715198482785906, 0.2637003899684974, 0.232373835252864, 0.2226645935858999, 0.226729357349021, 0.2122547711644853, 0.1618206075259617, 0.1602925546467304, 0.1354592610150575, 0.1050449588469096, 0.1167746984532901, 0.091763961927167, 0.0948824515300137, 0.0718029545886176, 0.0503325337943221, 0.1010207760014704, 0.0545706143602728, 0.0445708812081388, 0.0537539143780512, 0.044553385315729, 0.026905871728169, 0.0615459384529718, 0.0338236625705446, 0.0382997746845441, 0.0297419927082955, 0.0420706846219088, 0.0165183259606627, 0.0299087548961064, 0.0261736992147884, 0.0372731072295989, 0.0242170435376465, 0.0219212967702852, 0.0267094447543578, 0.0271357840725353, 0.0350166856909969, 0.0258161573271666, 0.0359925992587315, 0.0188985717748957, 0.0235316027953688, 0.0280066999340696, 0.0126051216585827, 0.0332262713927775, 0.0112095306560929, 0.0115126347851141, 0.0086934321027781, 0.0216119128745049, 0.014029106091974, 0.0185240002714895, 0.01308923761826, 0.020975890003943, 0.0101141404759671, 0.0173458548295976, 0.0110236345540865, 0.0291914840761039, 0.0314807530958205, 0.0361976026158247, 0.0382189249752887],
    'Test loss':[0.5930132120847702, 0.4875960722565651, 0.5039553195238113, 0.4528853818774223, 0.4355150088667869, 0.4406791925430298, 0.4202819317579269, 0.4453591406345367, 0.364767387509346, 0.4474448785185814, 0.4047795534133911, 0.4504925385117531, 0.388540156185627, 0.5180482566356659, 0.4043609499931335, 0.4388785064220428, 0.4482601284980774, 0.4729906246066093, 0.6044212281703949, 0.461168110370636, 0.5961211025714874, 0.5102530419826508, 0.5820726156234741, 0.5946208387613297, 0.6534962803125381, 0.6273593232035637, 0.6317964792251587, 0.5736605823040009, 0.6248479634523392, 0.6942498981952667, 0.5934007614850998, 0.6109147816896439, 0.5662775784730911, 0.5941388010978699, 0.6601933389902115, 0.7793160974979401, 0.5942946448922157, 0.6804604530334473, 0.6051440164446831, 0.7236369252204895, 0.6246316209435463, 0.629211813211441, 0.6578809097409248, 0.6651944518089294, 0.6074420064687729, 0.6492647230625153, 0.6122041940689087, 0.5940364822745323, 0.609313540160656, 0.7182160243391991, 0.5970434471964836, 0.6954473480582237, 0.6692087352275848, 0.6675038039684296, 0.5987227037549019, 0.6997227072715759, 0.6509468629956245, 0.8207241296768188, 0.7022616863250732, 0.9341428726911544, 0.8211350291967392, 0.8944784998893738, 0.8089767545461655, 0.7704379707574844, 0.814948320388794, 0.6960778012871742]
}

df_last_epoch = pd.DataFrame(data_last_epoch)

df_last_epoch.to_csv(f'{dataset}/{noise}/{seed}/loss_{method}.csv', index=False)
# df_last_epoch.to_csv(f'misc/sgd_loss.csv', index=False)

# Plot the data
plt.figure(figsize=(15, 8))
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Train loss'], marker='o', label='Train Loss', color='red')
plt.plot(df_last_epoch['Hidden Dimensions'], df_last_epoch['Test loss'], marker='o', label='Test Loss', color='blue')
plt.title('Results - loss curves - last epoch')
plt.xlabel('Hidden Dimensions')
plt.ylabel('Loss')
plt.legend()
# plt.xticks(df_last_epoch['Hidden Dimensions'])
plt.xticks(range(0, 1100, 50), fontsize=10)
plt.grid(True)
plt.tight_layout() 
plt.savefig(f'{dataset}/{noise}/{seed}/loss_{method}.png')  # Save the plot as an image file
# plt.savefig(f'misc/sgd_loss.png')  # Save the plot as an image file